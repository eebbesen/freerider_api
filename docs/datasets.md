First, export to csv from postgreSQL

    \copy (select * from vehicle_locations where location = 'twincities' and created_at > '2016-11-16') TO '~/tc_locs_since_nov_16_16_ex.csv' CSV HEADER

    \copy (select * from vehicle_locations where location = 'sandiego' and created_at > '2016-11-16') TO '~/sd_locs_since_nov_16_16_ex.csv' CSV HEADER

    \copy (select * from vehicle_locations where location = 'miami' and created_at > '2015-01-01') TO '~/miami_locs_since_jan_01_15_ex.csv' CSV HEADER

    \copy (select * from vehicle_locations where location like 'k%' and created_at > '2016-01-01') TO '~/k_locs_since_jan_01_01_ex.csv' CSV HEADER

    \copy (select * from vehicle_locations where location = 'stockholm' and created_at > '2016-11-01') TO '~/sh_locs_since_nov_01_16_ex.csv' CSV HEADER


Then group by filename since created at is insertion time, not data time

    select count(*), date_trunc('day', created_at)
      from vehicle_locations
     where location = 'twincities' 
       and created_at > '2016-11-15'
    group by date_trunc('day', created_at)
    order by date_trunc('day', created_at);


    select count(*), substr(filename, 0, 20)
      from vehicle_locations
     where location = 'twincities' 
       and created_at > '2016-12-01'
    group by substr(filename, 0, 20)
    order by substr(filename, 0, 20);

    select count(*), filename
      from vehicle_locations
     where location = 'twincities' 
       and created_at > '2016-12-01'
    group by filename
    order by filename;


Daily:

    6684:  twincities-20161201
    5399:  twincities-20161202
    4698:  twincities-20161203
    4297:  twincities-20161204
    3901:  twincities-20161205
    3826:  twincities-20161206
    3814:  twincities-20161207
    3668:  twincities-20161208
    3399:  twincities-20161209
    3713:  twincities-20161210
    3424:  twincities-20161211
    3131:  twincities-20161212
    3011:  twincities-20161213
    2493:  twincities-20161214
    2094:  twincities-20161215
    865:  twincities-20161216
    605:  twincities-20161217
    581:  twincities-20161218
    565:  twincities-20161219
    502:  twincities-20161220
    108:  twincities-20161221
    10:  twincities-20161222
    17:  twincities-20161223
    3:  twincities-20161224
    1:  twincities-20161225
    1:  twincities-20161226
    9:  twincities-20161227
    20:  twincities-20161228
    1:  twincities-20161229

Hourly:

292:  twincities-20161201_00
312:  twincities-20161201_01
308:  twincities-20161201_02
310:  twincities-20161201_03
314:  twincities-20161201_04
326:  twincities-20161201_05
334:  twincities-20161201_06
338:  twincities-20161201_07
340:  twincities-20161201_08
340:  twincities-20161201_09
336:  twincities-20161201_10
336:  twincities-20161201_11
326:  twincities-20161201_12
300:  twincities-20161201_13
274:  twincities-20161201_14
284:  twincities-20161201_15
310:  twincities-20161201_16
310:  twincities-20161201_17
296:  twincities-20161201_18
280:  twincities-20161201_19
214:  twincities-20161201_22
204:  twincities-20161201_23
208:  twincities-20161202_00
228:  twincities-20161202_01
232:  twincities-20161202_02
234:  twincities-20161202_03
363:  twincities-20161202_04
351:  twincities-20161202_05
240:  twincities-20161202_06
256:  twincities-20161202_07
252:  twincities-20161202_08
256:  twincities-20161202_09
125:  twincities-20161202_10
250:  twincities-20161202_11
252:  twincities-20161202_12
238:  twincities-20161202_13
194:  twincities-20161202_14
222:  twincities-20161202_15
238:  twincities-20161202_16
216:  twincities-20161202_17
214:  twincities-20161202_18
100:  twincities-20161202_19
234:  twincities-20161202_20
176:  twincities-20161202_21
170:  twincities-20161202_22
150:  twincities-20161202_23
178:  twincities-20161203_00
184:  twincities-20161203_01
198:  twincities-20161203_02
208:  twincities-20161203_03
202:  twincities-20161203_04
212:  twincities-20161203_05
214:  twincities-20161203_06
212:  twincities-20161203_07
222:  twincities-20161203_08
224:  twincities-20161203_09
226:  twincities-20161203_10
224:  twincities-20161203_11
226:  twincities-20161203_12
200:  twincities-20161203_14
194:  twincities-20161203_15
192:  twincities-20161203_16
186:  twincities-20161203_17
282:  twincities-20161203_18
194:  twincities-20161203_19
180:  twincities-20161203_20
182:  twincities-20161203_21
178:  twincities-20161203_22
180:  twincities-20161203_23
178:  twincities-20161204_00
89:  twincities-20161204_01
190:  twincities-20161204_02
98:  twincities-20161204_03
188:  twincities-20161204_04
192:  twincities-20161204_05
198:  twincities-20161204_06
198:  twincities-20161204_07
202:  twincities-20161204_08
206:  twincities-20161204_09
208:  twincities-20161204_10
208:  twincities-20161204_11
206:  twincities-20161204_12
206:  twincities-20161204_13
102:  twincities-20161204_14
192:  twincities-20161204_15
190:  twincities-20161204_16
196:  twincities-20161204_17
180:  twincities-20161204_18
172:  twincities-20161204_19
176:  twincities-20161204_20
170:  twincities-20161204_21
176:  twincities-20161204_22
176:  twincities-20161204_23
186:  twincities-20161205_00
188:  twincities-20161205_01
170:  twincities-20161205_02
188:  twincities-20161205_03
182:  twincities-20161205_04
96:  twincities-20161205_05
192:  twincities-20161205_06
99:  twincities-20161205_07
100:  twincities-20161205_08
198:  twincities-20161205_09
196:  twincities-20161205_10
196:  twincities-20161205_11
94:  twincities-20161205_13
162:  twincities-20161205_14
166:  twincities-20161205_15
180:  twincities-20161205_16
182:  twincities-20161205_17
200:  twincities-20161205_18
188:  twincities-20161205_19
202:  twincities-20161205_20
182:  twincities-20161205_21
178:  twincities-20161205_22
176:  twincities-20161205_23
190:  twincities-20161206_00
92:  twincities-20161206_01
202:  twincities-20161206_03
208:  twincities-20161206_04
208:  twincities-20161206_05
210:  twincities-20161206_06
212:  twincities-20161206_07
216:  twincities-20161206_08
216:  twincities-20161206_09
214:  twincities-20161206_10
107:  twincities-20161206_11
210:  twincities-20161206_12
182:  twincities-20161206_13
158:  twincities-20161206_14
178:  twincities-20161206_15
178:  twincities-20161206_16
166:  twincities-20161206_17
154:  twincities-20161206_18
164:  twincities-20161206_19
76:  twincities-20161206_20
144:  twincities-20161206_21
71:  twincities-20161206_22
70:  twincities-20161206_23
71:  twincities-20161207_00
152:  twincities-20161207_01
166:  twincities-20161207_02
164:  twincities-20161207_03
180:  twincities-20161207_04
87:  twincities-20161207_05
182:  twincities-20161207_06
182:  twincities-20161207_07
180:  twincities-20161207_08
184:  twincities-20161207_09
182:  twincities-20161207_10
182:  twincities-20161207_11
180:  twincities-20161207_12
170:  twincities-20161207_13
140:  twincities-20161207_14
162:  twincities-20161207_15
162:  twincities-20161207_16
176:  twincities-20161207_17
164:  twincities-20161207_18
160:  twincities-20161207_19
162:  twincities-20161207_20
148:  twincities-20161207_21
146:  twincities-20161207_22
132:  twincities-20161207_23
142:  twincities-20161208_00
168:  twincities-20161208_01
170:  twincities-20161208_02
158:  twincities-20161208_03
176:  twincities-20161208_04
172:  twincities-20161208_05
178:  twincities-20161208_06
178:  twincities-20161208_07
182:  twincities-20161208_09
176:  twincities-20161208_10
176:  twincities-20161208_11
174:  twincities-20161208_12
158:  twincities-20161208_13
134:  twincities-20161208_14
142:  twincities-20161208_15
166:  twincities-20161208_16
154:  twincities-20161208_17
144:  twincities-20161208_18
156:  twincities-20161208_19
140:  twincities-20161208_20
146:  twincities-20161208_21
144:  twincities-20161208_22
134:  twincities-20161208_23
142:  twincities-20161209_00
162:  twincities-20161209_02
160:  twincities-20161209_03
168:  twincities-20161209_04
178:  twincities-20161209_05
178:  twincities-20161209_06
184:  twincities-20161209_07
180:  twincities-20161209_08
184:  twincities-20161209_09
182:  twincities-20161209_10
178:  twincities-20161209_11
170:  twincities-20161209_12
81:  twincities-20161209_13
140:  twincities-20161209_14
146:  twincities-20161209_15
158:  twincities-20161209_16
160:  twincities-20161209_17
148:  twincities-20161209_18
74:  twincities-20161209_19
144:  twincities-20161209_20
138:  twincities-20161209_21
144:  twincities-20161209_23
136:  twincities-20161210_00
138:  twincities-20161210_01
150:  twincities-20161210_02
166:  twincities-20161210_03
84:  twincities-20161210_04
85:  twincities-20161210_05
184:  twincities-20161210_06
180:  twincities-20161210_07
188:  twincities-20161210_08
186:  twincities-20161210_09
190:  twincities-20161210_10
180:  twincities-20161210_11
182:  twincities-20161210_12
184:  twincities-20161210_13
176:  twincities-20161210_14
158:  twincities-20161210_15
160:  twincities-20161210_16
140:  twincities-20161210_17
148:  twincities-20161210_18
132:  twincities-20161210_19
148:  twincities-20161210_20
148:  twincities-20161210_21
148:  twincities-20161210_22
122:  twincities-20161210_23
142:  twincities-20161211_00
132:  twincities-20161211_01
142:  twincities-20161211_02
152:  twincities-20161211_03
156:  twincities-20161211_04
152:  twincities-20161211_05
150:  twincities-20161211_06
158:  twincities-20161211_07
158:  twincities-20161211_08
164:  twincities-20161211_09
166:  twincities-20161211_10
84:  twincities-20161211_11
168:  twincities-20161211_12
164:  twincities-20161211_13
160:  twincities-20161211_14
158:  twincities-20161211_15
152:  twincities-20161211_16
152:  twincities-20161211_17
74:  twincities-20161211_18
64:  twincities-20161211_19
142:  twincities-20161211_20
146:  twincities-20161211_21
144:  twincities-20161211_22
144:  twincities-20161211_23
142:  twincities-20161212_00
69:  twincities-20161212_01
146:  twincities-20161212_02
142:  twincities-20161212_03
148:  twincities-20161212_04
142:  twincities-20161212_05
138:  twincities-20161212_06
146:  twincities-20161212_07
146:  twincities-20161212_08
146:  twincities-20161212_09
146:  twincities-20161212_10
146:  twincities-20161212_11
140:  twincities-20161212_12
124:  twincities-20161212_13
94:  twincities-20161212_14
106:  twincities-20161212_15
116:  twincities-20161212_16
60:  twincities-20161212_17
124:  twincities-20161212_18
148:  twincities-20161212_19
136:  twincities-20161212_20
142:  twincities-20161212_21
136:  twincities-20161212_22
148:  twincities-20161212_23
134:  twincities-20161213_00
158:  twincities-20161213_01
80:  twincities-20161213_02
160:  twincities-20161213_03
164:  twincities-20161213_04
168:  twincities-20161213_05
162:  twincities-20161213_06
166:  twincities-20161213_07
84:  twincities-20161213_08
82:  twincities-20161213_09
162:  twincities-20161213_10
162:  twincities-20161213_11
156:  twincities-20161213_12
134:  twincities-20161213_13
114:  twincities-20161213_14
65:  twincities-20161213_15
132:  twincities-20161213_16
134:  twincities-20161213_17
134:  twincities-20161213_18
120:  twincities-20161213_19
118:  twincities-20161213_20
118:  twincities-20161213_21
52:  twincities-20161213_22
52:  twincities-20161213_23
100:  twincities-20161214_00
114:  twincities-20161214_01
60:  twincities-20161214_02
120:  twincities-20161214_03
124:  twincities-20161214_04
120:  twincities-20161214_05
124:  twincities-20161214_06
124:  twincities-20161214_07
120:  twincities-20161214_08
122:  twincities-20161214_09
122:  twincities-20161214_10
126:  twincities-20161214_11
122:  twincities-20161214_12
112:  twincities-20161214_13
100:  twincities-20161214_14
94:  twincities-20161214_15
100:  twincities-20161214_16
106:  twincities-20161214_17
96:  twincities-20161214_18
104:  twincities-20161214_19
104:  twincities-20161214_20
96:  twincities-20161214_21
42:  twincities-20161214_22
41:  twincities-20161214_23
98:  twincities-20161215_00
46:  twincities-20161215_01
98:  twincities-20161215_02
48:  twincities-20161215_03
108:  twincities-20161215_04
110:  twincities-20161215_05
106:  twincities-20161215_06
110:  twincities-20161215_07
108:  twincities-20161215_08
110:  twincities-20161215_09
106:  twincities-20161215_10
110:  twincities-20161215_11
108:  twincities-20161215_12
92:  twincities-20161215_13
78:  twincities-20161215_14
78:  twincities-20161215_15
88:  twincities-20161215_16
100:  twincities-20161215_17
90:  twincities-20161215_18
84:  twincities-20161215_19
66:  twincities-20161215_20
66:  twincities-20161215_21
72:  twincities-20161215_22
14:  twincities-20161215_23
24:  twincities-20161216_00
32:  twincities-20161216_01
44:  twincities-20161216_02
50:  twincities-20161216_03
56:  twincities-20161216_04
50:  twincities-20161216_05
52:  twincities-20161216_06
54:  twincities-20161216_07
56:  twincities-20161216_08
54:  twincities-20161216_09
54:  twincities-20161216_10
26:  twincities-20161216_11
24:  twincities-20161216_12
22:  twincities-20161216_13
24:  twincities-20161216_14
46:  twincities-20161216_15
38:  twincities-20161216_16
34:  twincities-20161216_17
22:  twincities-20161216_18
16:  twincities-20161216_19
26:  twincities-20161216_20
30:  twincities-20161216_21
20:  twincities-20161216_22
11:  twincities-20161216_23
26:  twincities-20161217_00
13:  twincities-20161217_01
32:  twincities-20161217_02
26:  twincities-20161217_03
28:  twincities-20161217_04
28:  twincities-20161217_05
26:  twincities-20161217_06
16:  twincities-20161217_07
32:  twincities-20161217_08
32:  twincities-20161217_09
30:  twincities-20161217_10
30:  twincities-20161217_11
30:  twincities-20161217_12
28:  twincities-20161217_13
26:  twincities-20161217_14
24:  twincities-20161217_15
22:  twincities-20161217_16
22:  twincities-20161217_17
28:  twincities-20161217_18
20:  twincities-20161217_19
20:  twincities-20161217_20
24:  twincities-20161217_21
20:  twincities-20161217_22
22:  twincities-20161217_23
28:  twincities-20161218_00
13:  twincities-20161218_01
13:  twincities-20161218_02
13:  twincities-20161218_03
13:  twincities-20161218_04
15:  twincities-20161218_05
30:  twincities-20161218_06
30:  twincities-20161218_07
30:  twincities-20161218_08
15:  twincities-20161218_09
30:  twincities-20161218_10
30:  twincities-20161218_11
30:  twincities-20161218_12
30:  twincities-20161218_13
30:  twincities-20161218_14
30:  twincities-20161218_15
32:  twincities-20161218_16
30:  twincities-20161218_17
22:  twincities-20161218_18
30:  twincities-20161218_19
11:  twincities-20161218_20
30:  twincities-20161218_21
20:  twincities-20161218_22
26:  twincities-20161218_23
30:  twincities-20161219_00
30:  twincities-20161219_01
30:  twincities-20161219_02
26:  twincities-20161219_03
28:  twincities-20161219_04
26:  twincities-20161219_05
30:  twincities-20161219_06
32:  twincities-20161219_07
30:  twincities-20161219_08
32:  twincities-20161219_09
30:  twincities-20161219_10
32:  twincities-20161219_11
30:  twincities-20161219_12
26:  twincities-20161219_13
26:  twincities-20161219_14
24:  twincities-20161219_15
11:  twincities-20161219_16
9:  twincities-20161219_17
10:  twincities-20161219_18
10:  twincities-20161219_19
9:  twincities-20161219_20
12:  twincities-20161219_21
20:  twincities-20161219_22
22:  twincities-20161219_23
20:  twincities-20161220_00
22:  twincities-20161220_01
28:  twincities-20161220_02
28:  twincities-20161220_03
32:  twincities-20161220_04
32:  twincities-20161220_05
16:  twincities-20161220_06
32:  twincities-20161220_07
32:  twincities-20161220_08
32:  twincities-20161220_09
30:  twincities-20161220_10
32:  twincities-20161220_11
30:  twincities-20161220_12
14:  twincities-20161220_13
26:  twincities-20161220_14
20:  twincities-20161220_15
11:  twincities-20161220_16
10:  twincities-20161220_17
11:  twincities-20161220_18
8:  twincities-20161220_19
12:  twincities-20161220_20
9:  twincities-20161220_21
11:  twincities-20161220_22
4:  twincities-20161220_23
5:  twincities-20161221_00
6:  twincities-20161221_01
7:  twincities-20161221_02
5:  twincities-20161221_03
6:  twincities-20161221_04
7:  twincities-20161221_05
7:  twincities-20161221_06
7:  twincities-20161221_07
7:  twincities-20161221_08
7:  twincities-20161221_09
6:  twincities-20161221_10
7:  twincities-20161221_11
7:  twincities-20161221_12
6:  twincities-20161221_13
5:  twincities-20161221_14
6:  twincities-20161221_15
5:  twincities-20161221_16
1:  twincities-20161221_18
1:  twincities-20161221_20
1:  twincities-20161222_15
1:  twincities-20161222_18
1:  twincities-20161222_19
1:  twincities-20161222_20
2:  twincities-20161222_21
2:  twincities-20161222_22
2:  twincities-20161222_23
2:  twincities-20161223_00
2:  twincities-20161223_01
2:  twincities-20161223_02
1:  twincities-20161223_04
1:  twincities-20161223_05
1:  twincities-20161223_06
1:  twincities-20161223_07
1:  twincities-20161223_08
1:  twincities-20161223_09
1:  twincities-20161223_10
1:  twincities-20161223_11
1:  twincities-20161223_12
1:  twincities-20161223_13
1:  twincities-20161223_14
1:  twincities-20161224_01
1:  twincities-20161224_02
1:  twincities-20161224_03
1:  twincities-20161225_04
1:  twincities-20161226_23
1:  twincities-20161227_14
1:  twincities-20161227_15
1:  twincities-20161227_17
1:  twincities-20161227_18
1:  twincities-20161227_19
1:  twincities-20161227_20
1:  twincities-20161227_21
1:  twincities-20161227_22
1:  twincities-20161227_23
1:  twincities-20161228_00
1:  twincities-20161228_01
1:  twincities-20161228_02
1:  twincities-20161228_03
1:  twincities-20161228_04
1:  twincities-20161228_05
1:  twincities-20161228_06
1:  twincities-20161228_07
1:  twincities-20161228_08
1:  twincities-20161228_09
1:  twincities-20161228_10
1:  twincities-20161228_11
1:  twincities-20161228_12
1:  twincities-20161228_13
1:  twincities-20161228_14
1:  twincities-20161228_15
1:  twincities-20161228_16
1:  twincities-20161228_21
1:  twincities-20161228_22
1:  twincities-20161228_23
1:  twincities-20161229_00
